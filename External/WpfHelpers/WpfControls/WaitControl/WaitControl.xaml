<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- From http://habrahabr.ru/post/102105/ -->
    
    
    <!-- USAGE (for example):
            <ListBox x:Name="ItemsListBox" 
                    Grid.Row="0" 
                    ItemsSource="{Binding Items, IsAsync=True}"
                    SelectedItem="{Binding SelectedItem}">
            <ListBox.Style>
                <Style TargetType="{x:Type ListBox}">
                    <Style.Triggers>
                        <Trigger Property="ItemsSource" Value="{x:Null}">
                            <Setter Property="Template" Value="{StaticResource WaitControlTemplate}" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListBox.Style>
        </ListBox>
    -->
    
    <ControlTemplate x:Key="WaitControlTemplate">
        <Border BorderThickness="1"
                BorderBrush="{x:Static SystemColors.ControlDarkDarkBrush}" Background="#CCADAEB0">
            <DockPanel HorizontalAlignment="Center" 
                       VerticalAlignment="Center">
                <Image Width="16" 
                       Height="16" 
                       Margin="5,0"
                       SnapsToDevicePixels="True"
                       Source="pack://application:,,,/WpfHelpers;component/WpfControls/WaitControl/loading_16.png">
                    <Image.RenderTransform>
                        <RotateTransform CenterX="8" CenterY="8" />
                    </Image.RenderTransform>
                    <Image.Triggers>
                        <EventTrigger RoutedEvent="Image.Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Image.RenderTransform).(RotateTransform.Angle)"
                                                                   RepeatBehavior="Forever"
                                                                   SpeedRatio="1.5">
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.125" Value="45.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.250" Value="90.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.375" Value="135.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.500" Value="180.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.625" Value="225.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.750" Value="270.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:0.875" Value="315.0" />
                                        <DiscreteDoubleKeyFrame KeyTime="0:0:1.000" Value="360.0" />
                                    </DoubleAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Image.Triggers>
                </Image>
                <StackPanel>
                    <TextBlock HorizontalAlignment="Center" Text="Подождите, идет обработка..." />
                </StackPanel>
            </DockPanel>
        </Border>
    </ControlTemplate>
</ResourceDictionary>